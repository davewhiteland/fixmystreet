[% extra_js = [
    version('/vendor/chart.min.js'),
    version('/cobrands/fixmystreet.com/dashboard.js')
] -%]
[% INCLUDE 'header.html', title = loc('Dashboard'), bodyclass => 'dashboard fullwidthpage' %]

<div class="dashboard-header">
    <h1>[% loc('Dashboard') %]</h1>
</div>

<div class="dashboard-row">
    <div class="dashboard-item dashboard-item--12">
        <h2>UK: All time</h2>
        <div class="labelled-line-chart">
            <canvas id="chart-all-reports" width="600" height="300"
                data-labels="[[% problem_periods.join(',') %]]"
                data-values-reports="[[% problems_reported_by_period.join(',') %]]"
                data-values-fixed="[[% problems_fixed_by_period.join(',') %]]"
                ></canvas>
            <span class="label" data-datasetindex="0"><strong style="color: #F4A140">[% problems_reported_by_period.last %]</strong><span>problems reported</span></span>
            <span class="label" data-datasetindex="1"><strong style="color: #62B356">[% problems_fixed_by_period.last %]</strong><span>reports marked as fixed</span></span>
        </div>
    </div>
</div>

<div class="dashboard-row">
    <div class="dashboard-item dashboard-item--6">
        <h2 class="dashboard-subheading">UK: Last 7 days</h2>
        <div class="dashboard-sparklines">
            <div>
                <div class="labelled-sparkline">
                    <canvas width="200" height="50" data-color="#F4A140" data-values="[% last_seven_days.problems.join(' ') %]"></canvas>
                    <span class="label" data-datasetindex="0"><strong style="color: #F4A140;">[% last_seven_days.problems_total %]</strong>
                    <span>problems reported</span></span>
                </div>
            </div>
            <div>
                <div class="labelled-sparkline">
                    <canvas width="200" height="50" data-color="#4FADED" data-values="[% last_seven_days.updated.join(' ') %]"></canvas>
                    <span class="label" data-datasetindex="0"><strong style="color: #4FADED;">[% last_seven_days.updated_total %]</strong>
                    <span>problems updated</span></span>
                </div>
            </div>
            <div>
                <div class="labelled-sparkline">
                    <canvas width="200" height="50" data-color="#62B356" data-values="[% last_seven_days.fixed.join(' ') %]"></canvas>
                    <span class="label" data-datasetindex="0"><strong style="color: #62B356;">[% last_seven_days.fixed_total %]</strong>
                    <span>problems marked as fixed</span></span>
                </div>
            </div>
        </div>
    </div>
    <div class="dashboard-item dashboard-item--6">
        <form class="dashboard-search">
            <h2>Show reports in your area</h2>
            <label for="pc">[% c.cobrand.enter_postcode_text || loc('Enter a nearby street name and area') %]</label>
            <p class="form-txt-submit-box">
                <input type="text" id="pc" class="form-control">
                <input type="submit" value="Go">
            </p>
            <a href="#" class="dashboard-search__geolocate-link">â€¦[% loc('or locate me automatically') %]</a>
        </form>
    </div>
</div>

<div class="dashboard-row">
    <div class="dashboard-item dashboard-item--6">
        <h2 class="dashboard-subheading">Top 5 responsive councils</h2>
        <p>Average time between a problem being reported and being fixed, in the last 7 days.</p>
        <table class="dashboard-ranking-table">
            <tbody>
              [% FOR line IN top_five_bodies %]
                <tr><td>[% line.name %]</td><td>[% line.days %] days</td></tr>
              [% END %]
            </tbody>
            <tfoot>
                <tr><td>UK average</td><td>[% average %] days</td></tr>
            </tfoot>
        </table>
    </div>
    <div class="dashboard-item dashboard-item--6">
        <h2 class="dashboard-subheading">Top 5 most used categories</h2>
        <p>Number of problems reported in each category, in the last 7 days.</p>
        <table class="dashboard-ranking-table">
            <tbody>
              [% FOR line IN top_five_categories %]
                <tr><td>[% line.category %]</td><td>[% line.get_column('count') %] reports</td></tr>
              [% END %]
            </tbody>
            <tfoot>
                <tr><td>Other categories</td><td>[% other_categories %] reports</td></tr>
            </tfoot>
        </table>
    </div>
</div>

[% INCLUDE 'footer.html' %]
